---
title: "Emission from Cereal Food Production"
author: Nomvume Sandi
format: pdf
editor: visual
---

## Introduction

You should write actual content to introduce the topic and the data.

Instead of importing individual packages, a better option would be to import the tidyverse package once. 

```{r}
#Importing data from Csv the emission data
library(tidyverse)
emission_data <- read_csv("https://raw.githubusercontent.com/xrander/bootcamp-test/master/data/emission_data.csv")

emission_data
```



```{r}
#converting emission from tonnes to kilo tonnes(1000 tons = 1kilo tonnes)
emission_data |> 
  mutate(
   kilo_emission =emission/1000)

```

# Exploratory data analysis for emission_data
```{r}
#head(data) represents the top 6 rows of the emission_data quick snapshot
head(emission_data)
```

You do not need to explain what the functions are for. Instead, explain the results
```{r}
#tail(data) represents the bottom 6 rows of the emission data quick snapshot
tail(emission_data)
```


```{r}
#summary provides overview of the data , five number summary(min,max,1st qartile , 3rd quartile , Range)
```


```{r}
summary(emission_data)
#provides a summary of the data frameâ€™s columns
str(emission_data)


```

# Visualisation

## Total emissions of countries to plot (group the countries and sum up)
```{r}

total_emissions <- emission_data|>
  group_by(code) |>
  summarize(total_emission = sum(emission, na.rm = TRUE))
print(total_emissions)
```


maximum and minimum of the total emission to only map them in a graph 

```{r}

top_20_emissions <- total_emissions |>
  slice_max(order_by = total_emissions, n = 20)
```


```{r}
Bottom_20_emission <- total_emissions |>
  slice_min(order_by = total_emissions, n = 20)
```


```{r}
print(top_20_emissions)
print(Bottom_20_emission)
```

showing the top 20 emissions per country


```{r}
ggplot(top_20_emissions, aes(x = reorder(code, total_emission), y = total_emission)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(
    x = "Country Code",
    y = "Total Emission",
    title = "Top 20 Total Emissions per Country"
  ) +
  theme_light() +
  coord_flip()
```


Bottom emissions


```{r}

ggplot(Bottom_20_emission, aes(x = reorder(code, total_emission), y = total_emission)) +
  geom_bar(stat = "identity", fill = "red") +
  labs(
    x = "Country Code",
    y = "Total Emission",
    title = "Bottom  20 Total Emissions per Country"
  ) +
  theme_light() +
  coord_flip()
```

Total emissions per product


```{r}

product_emissions <- emission_data|>
  group_by(products) |>
  summarize(total_emission = sum(emission, na.rm = TRUE))
print(product_emissions)

```

Sum of product contribution


```{r}

ggplot(product_emissions, aes(x = products, y = total_emission, fill = products)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Total Emissions by Product",
    x = " By Product",
    y = "Total Emissions",
    fill = "Product"
  ) +
  theme_classic()
```
